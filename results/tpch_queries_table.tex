{\tiny
\begin{longtable}{|p{0.5cm}|p{7cm}|p{7cm}|}
\hline
{\bf Q. No.} & {\bf Hidden Query} & {\bf Extracted Query} \\\hline\hline
Q1&
Select l\_returnflag, l\_linestatus, sum(l\_quantity) as sum\_qty, sum(l\_extendedprice) as sum\_base\_price, sum(l\_extendedprice * (1 - l\_discount)) as sum\_disc\_price, sum(l\_extendedprice *(1 - l\_discount) * (1 + l\_tax)) as sum\_charge, avg(l\_quantity) as avg\_qty, avg(l\_extendedprice) as avg\_price, avg(l\_discount) as avg\_disc, count(*) as count\_order From lineitem Where l\_shipdate <= date '1998-12-01' - interval '71 days' Group By l\_returnflag, l\_linestatus Order by l\_returnflag, l\_linestatus;&
(Select l\_returnflag, l\_linestatus, Sum(l\_quantity) as sum\_qty, Sum(l\_extendedprice) as sum\_base\_price, Sum(l\_extendedprice-1.0*l\_extendedprice*l\_discount) as sum\_disc\_price, Sum(l\_extendedprice-1.0*l\_extendedprice*l\_discount+l\_extendedprice*l\_tax-1.0*l\_extendedprice*l\_discount*l\_tax) as sum\_charge, Avg(l\_quantity) as avg\_qty, Avg(l\_extendedprice) as avg\_price, Avg(l\_discount) as avg\_disc, Count(*) as count\_order From lineitem Where l\_shipdate  <= '1998-09-21' Group By l\_returnflag, l\_linestatus Order By l\_returnflag asc, l\_linestatus asc);\\\hline
Q2&
Select s\_acctbal, s\_name, n\_name, p\_partkey, p\_mfgr, s\_address, s\_phone, s\_comment From part, supplier, partsupp, nation, region Where p\_partkey = ps\_partkey and s\_suppkey = ps\_suppkey and p\_size = 38 and p\_type like '\%TIN' and s\_nationkey = n\_nationkey and n\_regionkey = r\_regionkey and r\_name = 'MIDDLE EAST' Order by s\_acctbal desc, n\_name, s\_name, p\_partkey Limit 100;&
(Select s\_acctbal, s\_name, n\_name, p\_partkey, p\_mfgr, s\_address, s\_phone, s\_comment From region, part, nation, partsupp, supplier Where p\_partkey = ps\_partkey and s\_suppkey = ps\_suppkey and s\_nationkey = n\_nationkey and r\_regionkey = n\_regionkey and r\_name  = 'MIDDLE EAST' and p\_type LIKE '\%TIN' and p\_size = 38 Order By s\_acctbal desc, n\_name asc, s\_name asc Limit 100);\\\hline
Q3&
Select l\_orderkey, sum(l\_extendedprice * (1 - l\_discount)) as revenue, o\_orderdate, o\_shippriority From customer, orders, lineitem Where c\_mktsegment = 'BUILDING' and c\_custkey = o\_custkey and l\_orderkey = o\_orderkey and o\_orderdate < date '1995-03-15' and l\_shipdate > date '1995-03-15' Group By l\_orderkey, o\_orderdate, o\_shippriority Order by revenue desc, o\_orderdate Limit 10;&
(Select l\_orderkey, Sum(l\_extendedprice-1.0*l\_extendedprice*l\_discount) as revenue, o\_orderdate, o\_shippriority From customer, lineitem, orders Where c\_custkey = o\_custkey and o\_orderkey = l\_orderkey and c\_mktsegment  = 'BUILDING' and l\_shipdate  >= '1995-03-17' and o\_orderdate  <= '1995-03-15' Group By l\_orderkey, o\_orderdate, o\_shippriority Order By revenue asc, o\_orderdate asc Limit 10);\\\hline
Q4&
Select o\_orderdate, o\_orderpriority, count(*) as order\_count From orders Where o\_orderdate >= date '1997-07-01' and o\_orderdate < date '1997-07-01' + interval '3' month Group By o\_orderdate, o\_orderpriority Order by o\_orderpriority Limit 10;&
(Select o\_orderdate, o\_orderpriority, Count(*) as order\_count From orders Where o\_orderdate  >= '1997-07-01' and o\_orderdate <= '1997-10-01' Group By o\_orderdate, o\_orderpriority Order By o\_orderpriority asc, o\_orderdate asc Limit 10);\\\hline
Q5&
Select n\_name, sum(l\_extendedprice * (1 - l\_discount)) as revenue From customer, orders, lineitem, supplier, nation, region Where c\_custkey = o\_custkey and l\_orderkey = o\_orderkey and l\_suppkey = s\_suppkey and c\_nationkey = s\_nationkey and s\_nationkey = n\_nationkey and n\_regionkey = r\_regionkey and r\_name = 'MIDDLE EAST' and o\_orderdate >= date '1994-01-01' and o\_orderdate < date '1994-01-01' + interval '1' year Group By n\_name Order by revenue desc Limit 100;&
(Select n\_name, Sum(l\_extendedprice-1.0*l\_extendedprice*l\_discount) as revenue From region, orders, lineitem, nation, customer, supplier Where s\_suppkey = l\_suppkey and s\_nationkey = n\_nationkey = c\_nationkey and c\_custkey = o\_custkey and o\_orderkey = l\_orderkey and r\_regionkey = n\_regionkey and r\_name  = 'MIDDLE EAST' and o\_orderdate  >= '1994-01-01' and o\_orderdate <= '1994-12-31' Group By n\_name Order By revenue asc, n\_name asc Limit 100);\\\hline
Q6&
Select l\_shipmode, sum(l\_extendedprice * l\_discount) as revenue From lineitem Where l\_shipdate >= date '1994-01-01' and l\_shipdate < date '1994-01-01' + interval '1' year and l\_quantity < 24 Group By l\_shipmode Limit 100;&
(Select l\_shipmode, Sum(l\_extendedprice*l\_discount) as revenue From lineitem Where l\_quantity  <= 23.0 and l\_shipdate  >= '1994-01-01' and l\_shipdate <= '1995-01-01' Group By l\_shipmode Order By l\_shipmode asc Limit 100);\\\hline
Q10&
Select c\_name, sum(l\_extendedprice * (1 - l\_discount)) as revenue, c\_acctbal, n\_name, c\_address, c\_phone, c\_comment From customer, orders, lineitem, nation Where c\_custkey = o\_custkey and l\_orderkey = o\_orderkey and o\_orderdate >= date '1994-01-01' and o\_orderdate < date '1994-01-01' + interval '3' month and l\_returnflag = 'R' and c\_nationkey = n\_nationkey Group By c\_name, c\_acctbal, c\_phone, n\_name, c\_address, c\_comment Order by revenue desc Limit 20;&
(Select c\_name, Sum(l\_extendedprice-1.0*l\_extendedprice*l\_discount) as revenue, c\_acctbal, n\_name, c\_address, c\_phone, c\_comment From orders, customer, nation, lineitem Where n\_nationkey = c\_nationkey and c\_custkey = o\_custkey and o\_orderkey = l\_orderkey and o\_orderdate  >= '1994-01-01' and o\_orderdate <= '1994-03-31' and l\_returnflag  = 'R' Group By c\_name, c\_address, c\_phone, c\_acctbal, c\_comment, n\_name Order By revenue asc, c\_name asc, c\_acctbal asc, c\_phone asc, n\_name asc, c\_address asc, c\_comment asc Limit 20);\\\hline
Q11&
Select ps\_COMMENT, sum(ps\_supplycost * ps\_availqty) as value From partsupp, supplier, nation Where ps\_suppkey = s\_suppkey and s\_nationkey = n\_nationkey and n\_name = 'ARGENTINA' Group By ps\_COMMENT Order by value desc Limit 100;&
(Select ps\_comment, Sum(ps\_availqty*ps\_supplycost) as value From nation, supplier, partsupp Where s\_suppkey = ps\_suppkey and s\_nationkey = n\_nationkey and n\_name  = 'ARGENTINA' Group By ps\_comment Order By value desc, ps\_comment asc Limit 100);\\\hline
Q16&
Select p\_brand, p\_type, p\_size, count(ps\_suppkey) as supplier\_cnt From partsupp, part Where p\_partkey = ps\_partkey and p\_brand = 'Brand#45' and p\_type Like 'SMALL PLATED\%' and p\_size >= 4 Group By p\_brand, p\_type, p\_size Order by supplier\_cnt desc, p\_brand, p\_type, p\_size;&
(Select p\_brand, Count(*) as p\_type, p\_size, Count(*) as supplier\_cnt From part, partsupp Where p\_partkey = ps\_partkey and p\_brand  = 'Brand#45' and p\_type LIKE 'SMALL PLATED\%' and p\_size  >= 4 Group By p\_size);\\\hline
Q17&
Select AVG(l\_extendedprice) as avgTOTAL From lineitem, part Where p\_partkey = l\_partkey and p\_brand = 'Brand#52' and p\_container = 'LG CAN' ;&
(Select Avg(l\_extendedprice) as avgtotal From part, lineitem Where p\_partkey = l\_partkey and p\_brand  = 'Brand#52' and p\_container  = 'LG CAN' Limit 1);\\\hline
Q18&
Select c\_name, o\_orderdate, o\_totalprice, sum(l\_quantity) From customer, orders, lineitem Where c\_phone Like '27-\_\%' and c\_custkey = o\_custkey and o\_orderkey = l\_orderkey Group By c\_name, o\_orderdate, o\_totalprice Order by o\_orderdate, o\_totalprice desc Limit 100;&
(Select c\_name, o\_orderdate, o\_totalprice, Sum(l\_quantity) as sum From customer, orders, lineitem Where c\_custkey = o\_custkey and o\_orderkey = l\_orderkey and c\_phone LIKE '27-\%' Group By c\_name, o\_totalprice, o\_orderdate Order By o\_orderdate asc, o\_totalprice desc, c\_name asc Limit 100);\\\hline
Q21&
Select s\_name, count(*) as numwait From supplier, lineitem l1, orders, nation Where s\_suppkey = l1.l\_suppkey and o\_orderkey = l1.l\_orderkey and o\_orderstatus = 'F' and s\_nationkey = n\_nationkey and n\_name = 'GERMANY' Group By s\_name Order by numwait desc, s\_name Limit 100;&
(Select s\_name, Count(*) as numwait From nation, lineitem, orders, supplier Where s\_suppkey = l\_suppkey and s\_nationkey = n\_nationkey and o\_orderkey = l\_orderkey and n\_name  = 'GERMANY' and o\_orderstatus  = 'F' Group By s\_name Order By s\_name asc Limit 100);\\\hline
\end{longtable}}