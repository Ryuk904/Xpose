Testing:


HQ =
select l_orderkey as orderkey, max(l_extendedprice - l_tax + l_discount) as revenue, o_orderdate as orderdate, o_shippriority as shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate, l_orderkey limit 10; ...
inside:   reveal_proc_support.refine_Query
=========== Extracted Query =============
Select o_orderkey as orderkey, l_quantity as revenue, o_orderdate as orderdate, o_shippriority as shippriority
From orders, lineitem, customer
Where c_custkey = o_custkey and o_orderkey = l_orderkey and o_orderdate  <= '1995-03-14' and l_shipdate  >= '1995-03-16' and c_mktsegment  = 'BUILDING'
Group By o_orderkey, o_orderdate, o_shippriority
Order By revenue desc
Limit 10;

————
HQ = select l_orderkey as orderkey, sum(l_extendedprice - l_discount + l_tax) as revenue, o_orderdate as orderdate, o_shippriority as shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate, l_orderkey limit 10;
=========== Extracted Query =============
Select o_orderkey as orderkey, l_discount as revenue, o_orderdate as orderdate, o_shippriority as shippriority
From orders, lineitem, customer
Where c_custkey = o_custkey and o_orderkey = l_orderkey and o_orderdate  <= '1995-03-14' and l_shipdate  >= '1995-03-16' and c_mktsegment  = 'BUILDING'
Group By o_orderkey, o_orderdate, o_shippriority
Order By revenue desc
Limit 10;

———
HQ = select l_orderkey as orderkey, sum(l_extendedprice * l_discount - o_totalprice) as revenue, o_orderdate as orderdate, o_shippriority as shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate, l_orderkey limit 10;


Intermediate Values of all [2, 2, 5, 4, 10, 10, 20, 1]
Traceback (most recent call last):
  File "/Users/ahanapradhan/opt/anaconda3/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/Users/ahanapradhan/opt/anaconda3/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/ahanapradhan/PycharmProjects/UN1/mysite/unmasque/src/main_cmd.py", line 16, in <module>
    eq, time = ExtractionPipeLine.extract(hq)
  File "/Users/ahanapradhan/PycharmProjects/UN1/mysite/unmasque/src/core/ExtractionPipeLine.py", line 139, in extract
    check = agg.doJob(query)
  File "/Users/ahanapradhan/PycharmProjects/UN1/mysite/unmasque/refactored/abstract/ExtractorBase.py", line 26, in doJob
    self.result = self.doActualJob(args)
  File "/Users/ahanapradhan/PycharmProjects/UN1/mysite/unmasque/refactored/abstract/GenerationPipeLineBase.py", line 41, in doActualJob
    check = self.doExtractJob(query, attrib_types_dict, filter_attrib_dict)
  File "/Users/ahanapradhan/PycharmProjects/UN1/mysite/unmasque/refactored/aggregation.py", line 237, in doExtractJob
    inter_val.append(int(temp_ar[j][1][i]))
IndexError: tuple index out of range


————
HQ = select l_orderkey as orderkey, sum(l_extendedprice * l_discount * l_quantity) as revenue, o_orderdate as orderdate, o_shippriority as shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate, l_orderkey limit 10; ...
inside:   reveal_proc_support.refine_Query
=========== Extracted Query =============
Select o_orderkey as orderkey, Sum(+l_quantity*l_extendedprice*l_discount) as revenue, o_orderdate as orderdate, o_shippriority as shippriority
From orders, customer, lineitem
Where c_custkey = o_custkey and o_orderkey = l_orderkey and o_orderdate  <= '1995-03-14' and c_mktsegment  = 'BUILDING' and l_shipdate  >= '1995-03-16'
Group By o_orderkey, o_orderdate, o_shippriority
Order By revenue asc
Limit 10;




